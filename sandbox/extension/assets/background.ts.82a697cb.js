import{d as o}from"./index.ec331754.js";import{s as A,c as w}from"./utils.dde6fc61.js";chrome.runtime.onMessage.addListener(async(u,t,g)=>{var p;const{target:d,action:s,outerWidth:l}=u,c=(p=t==null?void 0:t.tab)==null?void 0:p.id,n=t==null?void 0:t.origin;if(d!==o.MessageTarget.Extension||!c||!n)return;const m=`radix#chromeExtension#message#${s.id}`,h={target:d,action:s,createdAt:Date.now(),tabId:c,url:n};if(s.type===o.ActionType.GetAccountAddress)chrome.storage.local.get(null,i=>{const r=i.network,e=i[`${r}/activeAccountAddress`],a={tabId:c,url:n,action:{id:s.id,type:e?o.ActionType.GetAccountAddressSuccess:o.ActionType.GetAccountAddressFailure,payload:e},target:o.MessageTarget.Dapp,createdAt:Date.now()};console.log(a),A(a)});else if(s.type===o.ActionType.SignTransaction){const r=(await w.tabs.getExtensionTabsByUrl(chrome.runtime.id)).length>0;await chrome.storage.local.set({[m]:h}),r?chrome.storage.local.get("popupId",async e=>{const a=Object.values(e)[0];a&&await chrome.windows.update(a,{focused:!0})}):await chrome.windows.create({url:chrome.runtime.getURL("index.html"),type:"popup",width:320,height:600,top:110,left:l-320},async e=>{await chrome.storage.local.set({popupId:e.id})})}g(!0)});
